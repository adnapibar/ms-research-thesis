% Chapter 2

% Main chapter title
\chapter{Traffic Prediction: Literature Review}

% For referencing the chapter elsewhere, use \ref{Chapter2}
\label{Chapter2}

% This is for the header on each page - perhaps a shortened title
\lhead{Chapter 2. \emph{Traffic Prediction: Literature Review}}

% Quotation
{``There is no way that we can predict the weather six months ahead beyond giving the seasonal
average"}
\begin{flushright}
Stephen Hawking, \textit{Black Holes and Baby Universes} (1993)
\end{flushright}

%---------------------------------------------------------------------------------------------------
%	CONTENT
%---------------------------------------------------------------------------------------------------
\section{Introduction}
In this chapter we provide an account of various elements involved in short term traffic prediction
as a process and a reasonably complete review of existing literature. Research on short term traffic
prediction has been active since 1970's. Yet many professionals around the
world still show a strong interest in this field.
The simplest reason being the complex non-linear nature of traffic data and the effects of
non-recurrent events (weather, public events, accidents etc.) on it.  Critical reviews of existing
literature on short term traffic flow have been presented in detail by \citet{smith1997traffic},
\citet{vlahogianni2004short}, \citet{van2012short} and \citet{vlahogianni2014short}. The use of
the phrase 'short term' limits the scope of traffic prediction in terms of the prediction horizon
which usually varies between few seconds to few hours depending upon the approach and application.

The process of short term traffic prediction consists of determining the scope, formulating the
conceptual output specifications and model selection (\citet{vlahogianni2004short}) as shown in
figure \ref{fig:sttp-process}.

\begin{figure}[htbp]
  \centering
    \includegraphics[width=0.7\textwidth,height=0.7\textheight,keepaspectratio]{Figures/sttp-process.pdf}
    \rule{35em}{0.5pt}
  \caption[Elements of short term traffic prediction]{Elements of short term traffic prediction}
  \label{fig:sttp-process}
\end{figure}

Determining whether the prediction model to be developed is going to be part of an advanced
traffic management system or advanced traveller information system is important. This decision is influenced
by other elements such as type of road and traffic parameters involved. However, a suitable
forecasting method that can be easily integrated into these systems is still elusive.

The type of area influences the prediction process. Short term traffic predictions can be done for
highway, freeway and urban arterial roads. Most of the existing works focus on either highway or
freeway traffic. The reason being predicting traffic conditions at a urban setting is more complex.
While predicting traffic conditions at highways and freeways are important for both advanced traffic
management systems and advanced traveller information systems, for urban settings the need for short
term traffic predictions is more relevant for signal control at intersections.

The traffic parameters that are predicted can be - flow (number of vehicles per hour), time (minutes
to travel between two points), speed (mean speed in km/hour) and density (number of vehicles per km).
Relevance of flow is more stable and important than other parameters as per \citet{levin1980forecasting}.
However this is conflicting and many authors have argued otherwise. \citet{dougherty1997short} attempted
to determine the parameter that best describes the traffic conditions and their findings suggested that
flow and density are more relevant than speed. Predicting travel time has also been the focus of many
works, especially in recent years. This is because of its importance when it comes to advanced traveller
information systems, while flow and density are more important for advanced traffic management systems.
While a lot of earlier works have gone into predicting one of the parameters, there have been few
attempts to predict a combination of traffic parameters. There are also non-recurrent events such as
accidents, severe weather, public events etc. that affect traffic conditions. Not many attempts have
been made to include these as input parameters while creating a forecasting model. This is because
the influence of these have been found to be ambiguous. Recently \citet{tsirigotis2012does}
studied the influence of weather on the performance of traffic forecasting models. The authors observed
a very marginal improvement in the performance with the inclusion of weather data as an exogenous
variable.

Forecasting horizon and step are also important and they show the stability of the method. It is worth
noticing that forecast horizon is the total amount of time we are trying to predict ahead while
the number of steps depends on the frequency of traffic data. For instance with data collected at 5 minutes interval,
we may want to predict the traffic flow in next 15 minutes, where this is the forecast horizon, the
forecast step is 3. By intuition we can understand that the accuracy will suffer as we expand the
forecast horizon. The \textit{Highway Capacity Manual} (2000) suggests that the best forecast horizon
for short term traffic prediction is 15 minutes. \citet{yue2007prediction} empirically examined the
relationship among prediction horizon, the effectiveness of real-time data and traffic predictability.
They concluded that the choice of a model can be affected by the understanding of this relationship.

One of the other aspects to consider is the importance of spatial relationships in traffic flow data
along with its temporal characteristics. The reason being that this fully captures the dynamics of
traffic conditions and is a more accurate representation of traffic flow characteristics. Several
attempts have been made to incorporate traffic flow from upstream, downstream and adjacent locations
to increase the prediction accuracy. \citet{cheng2012spatio} provides an extensive examination of the
spatiotemporal characteristics of traffic data and an exploratory autocorrelation analysis.

Selecting the right model for short term traffic prediction is a challenging task. A number of
models have been suggested and yet there is no consensus on a globally acceptable method.
The various methods that have been suggested for short term traffic prediction can be categorised into four
groups - na誰ve, parametric, non-parametric and hybrid as shown in figure \ref{fig:sttp-methods}.

\begin{figure}[htbp]
  \centering
    \includegraphics[width=0.4\textwidth,height=0.4\textheight,keepaspectratio]{Figures/sttp-methods.pdf}
    \rule{35em}{0.5pt}
  \caption[Methods in short term traffic prediction]{Methods in short term traffic prediction}
  \label{fig:sttp-methods}
\end{figure}

In the following sections, we review significant amount of earlier works in this field, grouped by the
type of method.

\section{Na誰ve methods}
These are heuristics methods, and often used in practice because of their simplicity and the ease
of implementations. In most cases these methods are used as baselines for comparison while
creating more advanced methods. We briefly present these methods here.

\subsection{The Na誰ve method}
The simplest naive approach in short term prediction would be to take the last observed value and
this involves no computational effort. Formally, at any time t the prediction is given as

        \begin{equation}
            \hat{x}_{t} = x_{t-1}
        \end{equation}

Another variant of this method is known as seasonal Na誰ve method, where the estimate at any time t is
last observed value from the same season of the year. This is mainly used for highly seasonal time
series data.

\subsection{Average method}
Another simple heuristic method known as the historical averages uses the average of past observed
values. We define this as

        \begin{equation}
            \hat{x}_{t} = (x_{t-1} + x_{t-2} ... + x_{t-n})/n
        \end{equation}

\section{Parametric methods}
In parametric models, we estimate the parameters from the training dataset to determine the
function that make predictions for new unseen data. The number of parameters are fixed. The advantage of
parametric models are that these perform quite well in situations where large amount of data
is not available. Some of the typical examples of parametric models include Linear and
nonlinear regressions, ARIMA models, Kalman filters etc.

\subsection{Classical regression}
In machine learning and statistical applications, the use of linear models are predominant. These
models are also important in time series domains such as traffic flow prediction. The primary
idea behind the regression is to express the output variable as a linear combination of input
vectors. We can express the linear regression in time series as an output influenced by a
collection of inputs, where the inputs could possibly be an independent series

        \begin{equation}
            x_{t} = \beta_{1}z_{t1} + \beta_{2}z_{t2} + ... + \beta_{q}z_{tq} + w_{t}
        \end{equation}

where $ \beta_{1}, \beta_{2},...,\beta_{q} $ are unknown regression coefficients and $w_{t}$ is
a random error.

A very few attempts have been made to model the traffic conditions using linear and non-linear
models of regression in the field of short term traffic prediction. The simplest reason being the
inability of these statistical methods to capture the highly nonlinear and complex relationships that
are present in the traffic data. \citet{low1972new} and \citet{jensen1973calibrating}
used linear models of regression for predicting traffic volumes while \citet{hogberg1976estimation}
used nonlinear regression for traffic prediction. \citet{rice2004simple} revisited the application of
linear regression to short term traffic prediction. They used this approach to predict travel time
on freeways. For their method, they created a matrix $V$ with entries $V(d,l,t)$ which denotes the
measured velocity on day $d$ at loop $l$ at time $t$. Using this matrix they calculated $TT_{d}(a,b,t)$,
which is the time it took to travel from $a$ to $b$ at time $t$ on a day $d$. They calculated another
proxy value for these times, which would have been the travel time if traffic conditions were remained
constant, this was denoted as $T^*_{d}(a,b,t)$. Using empirical analysis they observed a linear
relationship between $T^*(t)$ and $TT(t+\delta)$ and proposed a linear regression model to capture this
relationship.

\citet{lan1999real} proposed a recursive algorithm by using a dynamic generalised linear model
in this context to predict traffic flow. In this work a negative binomial probability distribution
was chosen. The flow data used in this experiment was obtained using a video camera and counted
manually and hence a very small set of data, containing only 139 observations at 20 seconds interval,
was used for model evaluation.

\subsection{ARIMA}
ARIMA (Auto Regressive Integrated Moving Average) is a class of parametric regression models. In
this section we will introduce ARIMA and related methods such as moving averages and autoregressive.
For an in depth understanding of these methods, the reader is encouraged to refer to to
~\citet{tong1990non}, ~\citet{brockwell2006introduction} and ~\citet{box2015time}. It is
important to understand that ARIMA modelling works only with stationary time series data. A
stationary time series is one whose properties do not depend on the time it is being observed at.
Trends and seasonality affect time series and hence make it non-stationary. Although this seems as a
big restriction, in short term traffic prediction, ARIMA models have been very successful. Two
basic models constitute ARIMA models - AR (autoregressive) and MA (moving average).

The main idea behind autoregressive models is that past values affect the present value, i.e.
$x_{t}$ can be expressed as a function of past p values $ x_{t-1}, x_{t-2},...,x_{t-p} $ , where
p is the number of steps into the past. We can express an autoregressive model of order p as below

        \begin{equation} \label{eq:autoregressive}
          x_{t} = \phi_{1}x_{t-1} + \phi_{2}x_{t-2} + ... + \phi_{p}x_{t-p} + w_{t}
        \end{equation}

where $x_{t}$ is stationary and $\phi_{1}, \phi_{2},..., \phi_{p}$ are constant
parameters that are to be chosen. We have added the term $w_{t}$ as a Gaussian white noise with
zero mean and variance $\sigma^{2}_{w}$.

In the MA model, the current value is dependent on the last q one-step forecast errors
$e_{t-1}, e_{t-2},...,e_{t-q}$ and the white noise $w_{t}$. The expression for moving average
is

        \begin{equation} \label{eq:movingaverage}
          x_{t} = -\theta_{1}e_{t-1} - \theta_{2}e_{t-2} - ... - \theta_{q}e_{t-q} + w_{t}
        \end{equation}

$\theta_{1}, \theta_{2},..., \theta_{q}$ are the parameters to be chosen.

Now proceeding to an ARMA (autoregressive moving average) model, we define an ARMA(p,q) model
where the present value $x_{t}$ is dependent on p past recent values and q past recent forecast
errors and a white noise $w_{t}$.

        \begin{equation} \label{eq:arma}
          x_{t} = \phi_{1}x_{t-1} + \phi_{2}x_{t-2} + ... + \phi_{p}x_{t-p} - \theta_{1}e_{t-1}
          - \theta_{2}e_{t-2} - ... - \theta_{q}e_{t-q} + w_{t}
        \end{equation}

When q is 0, the model becomes an autoregressive model of order p, AR(p) and when p is 0 the model
is a moving average of order q, MA(q). We can rewrite \ref{eq:arma} by using the backshift
operator $B^{\alpha}$, which is defined as $B^{\alpha}z_{t} = z_{t-\alpha}$,

        \begin{equation} \label{eq:armarewrite}
          \phi(B)x_{t} = \theta(B)e_{t}
        \end{equation}

where
        \begin{equation}
            \phi(z) = 1 - \phi_{1}z - ... - \phi_{p}z^{p}
        \end{equation}
        \begin{equation}
            \theta(z) = 1 - \theta_{1}z - ... - \theta_{q}z^{q}
        \end{equation}

In practice, most time series data are non-stationary and so several approaches, for instance
differencing, are used to make it stationary before applying the ARMA(p,q) model. By
combining differencing with autoregressive and moving averages, we obtain the ARIMA model which is
defined as below

        \begin{equation} \label{eq:arima}
          x'_{t} = \phi_{1}x'_{t-1} + \phi_{2}x'_{t-2} + ... + \phi_{p}x'_{t-p} -
          \theta_{1}e_{t-1} - \theta_{2}e_{t-2} - ... - \theta_{q}e_{t-q} + w_{t}
        \end{equation}

where $x'_{t}$ is the differenced series. Formally the model is denoted as ARIMA(p,d,q) where p
is the order of autoregressive part, d is the degree of differencing and q is the order of moving
average. This is also known as a non-seasonal ARIMA model.

The common method used to determine the parameters in an ARIMA(p,d,q) model is known as the
Box-Jenkins approach (\citet{box2015time}) which is a three stage procedure. The three stages are
identification, estimation and diagnostic checking. At the identification stage, the values p, d
and q are determined by observing the autocorrelation and partial autocorrelation functions of
the time series and its differences. At the estimation stage, the maximum likelihood estimates are
determined for each model parameter. Finally in the diagnostics stage, the residuals are analysed
and model comparisons are done. If the model fits well then the standardised residuals behave as
an i.i.d. with mean zero and variance one.

\citet{ahmed1979analysis} used Box-Jenkins method for short-term traffic forecast. The input data
used was 166 sets of time series traffic data collected by freeway traffic surveillance systems in
three locations - Los Angeles, Minneapolis and Detroit. The authors concluded an ARIMA(0,1,3)
model, based on the autocorrelation and partial autocorrelation functions, as a reasonable fit for
short term predictions of both traffic volume and occupancy. The model performance was
evaluated against a moving average, a double smoothing average and a Trigg and Leach adaptive
model. The comparisons suggest that the ARIMA model had better accuracy than the others. The
authors used this model in detecting traffic incidents by comparing the real-time flow occupancy
with the predicted value. \citet{nihan1980use} used the Box-Jenkins technique on monthly data
collected at 15 minutes interval on a freeway segment from 1968 to 1976 to forecast for the year
1977. After examining several models they finally selected an ARIMA(12,1,7) model. The forecast
was done for average weekday volume with positive results. \citet{hamed1995short} also studied the
application of ARIMA model in short term traffic volume prediction. They found a simple ARIMA(0,1,1)
model to be adequate for modelling the traffic data. The used a 1-min interval dataset collected in
five urban arterials.

\citet{williams2001multivariate} used an ARIMAX model to use upstream traffic data along with the
predicting location's traffic data while estimating the parameters of the ARIMA model. This was
done using ARIMAX model which is an extension of the ARIMA model where an exogenous variable is
used. The data was collected form four locations near Beaune, France. The data from three upstream
locations were used for forecasting at the fourth location in Beaune. The same data were used
in the proposed ATHENA (\citet{danech1991athena}) and KARIMA (\citet{van1996combining}) models.
The model was compared  against a univariate ARIMA model. The results show that
the ARIMAX model consistently outperformed the ARIMA model. However the complexity of the ARIMAX
model was more than the ARIMA model with as many as twice the parameters to estimate. Also in case
of missing values the ARIMAX model performance degraded more than the ARIMA model.

\citet{min2009short} proposed a dynamic Space Time ARIMA (STARIMA) model for short term traffic
prediction. Their argument for the new proposed model was based on the factor that most of the
existed model failed to take the spatial information of the transportation system into account.
The proposed dynamic STARIMA model combined STARIMA and Dynamic Turn Ratio Prediction (DTRP)
models. Using DTRP they dynamically updated the static matrix $W_{k}$ in STARIMA model that contains
the structural information of the transportation network. The results of the study showed
significant improvement in forecast accuracy. The authors later published another similar work
(\citet{min2010urban}) that used the generalised STARIMA (GSTARIMA) model.  The authors
presented the results where this model has a small improvements over the STARIMA model. However
the major drawbacks of the GSTARIMA model is the estimation of large number of parameters which
significantly increases the computational time. It also suffers in performance if enough historical
data is not available.

\citet{williams2003modeling} proposed for the acceptance of seasonal ARIMA models for short term
traffic prediction. A seasonal ARIMA $(p,d,q) (P,D,Q)_{s}$ for a time series {$x_{t}$} is one
where s is the period, d and D are nonnegative integers. The time series theorem known as the World
decomposition is used as the theoretical justification of applying seasonal ARIMA model to
univariate time series with stationarity. Data from two freeway locations, one each from the
United States and the United Kingdom were used for evaluating the model. The performance of the
models were compared against three heuristics approaches - historical averages, random walk and
deviation from historical averages. The results show that for both the locations the seasonal
ARIMA has better performance than the three methods mentioned earlier. However the authors did
not present whether a non-seasonal ARIMA model would have similar performance. The only other
model that was considered for comparison was the KARIMA model, which did not perform as good as
the seasonal ARIMA model. \citet{kumar2015short} also used a seasonal ARIMA in the context of
limited data for short term traffic prediction. They used data collected over three days from an
arterial road in Chennai, India for the study. The model was validated on 24 hours ahead forecast.
Their results were positive when compared with historical averages and na誰ve methods. They
argued when availability of large traffic dataset is a constraint seasonal ARIMA method is a
better choice.

The major deficiency of the ARIMA models is that they do not take the extremes into
consideration and focus on the means. This is in contrast to the nature of the traffic data.
ARIMA models are also have the inability to perform well with missing data, as pointed out by
\citet{smith1997traffic}.


\subsection{Kalman filter}
Kalman filter is a parametric regression technique usually used in the field of automatic control
systems and signal processing. It was proposed by \citet{kalman1960new}. It can be used to model
both stationary and non-stationary time series. We present a brief description of this theory, for
detail understanding the reader should refer to some extensive literature (such as
\citet{harvey1990forecasting}  and \citet{haykin2001kalman}). It is important to realise that Kalman
filer and state space model refer to the same basic theory.


The Kalman filter solves the problem of sequential state estimation of a dynamic linear system, where
in such a system the state evolution and the measurements are both linear and Gaussian. Let us consider
a state space model of the form

        \begin{equation} x_{n} = P_{n}x_{n-1} + \tau_{n} \end{equation}
        \begin{equation} y_{n} = Q_{n}y_{n-1} + \upsilon_{n} \end{equation}

where, $x_{n}$ and $y_{n}$ are the state and measurement respectively at time step n.
$P_{n}$ is a $N \times N$ state transition matrix and $\tau_{n}$ is a $N \times 1$ Gaussian
random state noise vector with zero mean and covariance matrix $R_{n}$. $Q_{n}$ is a $M \times N$
measurement matrix and $\upsilon_{n}$ is a $M \times 1$ Gaussian random measurement noise vector
with zero mean and covariance matrix $S_{n}$.

In this state-space setting, the two important tasks are - \textit{filtering} and \textit{prediction}.
The filtering problem is to estimate the state $x_{n}$ given the set of measurements
$Y_{n} = y_{1}, y_{2},...,y_{n}$. And the prediction problem is to predict $x_{n+t}$, that is the
state after t time steps, given the set of measurements $Y_{n}$. The Kalman filter algorithm can be
described using the below equations.

        1. Prediction step

        \begin{equation} m_{n|n-1} = P_{n}m_{n-1|n-1} \end{equation}
        \begin{equation} C_{n|n-1} = P_{n}C_{n-1|n-1}P^{T}_{n} + R_{n} \end{equation}

        2. Update step to estimate $\hat{x}_{n} = m_{n|n}$

        \begin{equation} J_{n} = Q_{n}C_{n|n-1}Q^{T}_{n} + S_{n} \end{equation}
        \begin{equation} K_{n} = C_{n|n-1}Q^{T}_{n}J^{-1}_{n} \end{equation}
        \begin{equation} m_{n|n} = m_{n|n-1} + K_{n}(y_{n} - Q_{n}m_{n|n-1}) \end{equation}
        \begin{equation} C_{n|n} = C_{n|n-1} - K_{n}Q_{n}C_{n|n-1} \end{equation}

where $m_{n|n}$ and $C_{n|n}$ are the Gaussian mean and covariance of state $x_{n}$ at time step n,
in the posterior probability distributed function

        \begin{equation} p(x_{n}|Y_{n}) \equiv \mathcal{N}(x_{n};m_{n|n},C_{n|n}) \end{equation}

The subscript notation $n|n$ denotes the recursive computation of the pdf of the state $x_{n}$ at
step n using the measurements up to time step n.

\begin{figure}[htbp]
  \centering
    \includegraphics[width=0.5\textwidth,height=0.5\textheight,keepaspectratio]{Figures/kalman-filter.pdf}
    \rule{35em}{0.5pt}
  \caption[Sequential Bayesian estimation in Kalman filtering]{Sequential Bayesian estimation in
  Kalman filtering, recursively computes the posterior probability $p(x_{n}|Y_{n})$}
  \label{fig:kalman-filter}
\end{figure}

\citet{okutani1984dynamic} proposed two models using Kalman filtering for short term traffic volume
predictions. The predictions of volume on a link were done using not only the data from that link but
also from adjacent links. They found, using these models, the average error rate to be around 9\%.
This shows the ability of Kalman filtering to predict in a multivariate setting which is difficult in
other statistical regression models such as ARIMA. \citet{stathopoulos2003multivariate} used traffic
data collected at 3-minutes interval from urban arterials to develop a multivariate time-series
state space model. For prediction of traffic flow at one location, both the data at that location
and from upstream were considered. The results of this model were compared against an ARIMA model.
The model performance was found to be superior than the ARIMA model. For one of the locations, the
mean absolute percentage error (MAPE) of the state space model was 12\%, compared to the 20\% MAPE value
of the ARIMA model. For other locations while the differnces were observed to be this large. The
authors also concluded that short term traffic flow prediction at urban arterials is a very difficult
task and can not be as accurate as the predictions at freeways.

\section{Non-Parametric methods}
In non-parametric methods the parameters are not fixed, and vary with the amount of data available.
Usually more data is required for these models than parametric methods. However, the main advantage
of these methods is that they can model complex non-linear data significantly better than the
parametric methods. Some of the widely used non-parametric models are - k-Nearest Neighbour,
Support Vector Machines and Neural Networks

\subsection{K-nearest neighbour}
K-nearest neighbour is a non-parametric regression method. In this approach the basic concept is based
on the idea of a phase space embedding and finding a neighbourhood in that. A phase space or state
space is a vector space that represents the state of a purely deterministic system. The points in this
phase space show the dynamics of such a system. For a time series, the problem of constructing a phase
space is known as phase space embedding. Given a time series ($x_{1},...x_{t}$) with scalar values,
in order to forecast $x_{t+1}$, a suitable value k is used which can be determined heuristically by
using an error measure such as RMSE.. The forecast algorithm then predicts the value by taking either
a simple arithmetic mean of k neighbours or a weighted average with respect to the distance. The
distance functions can be Euclidean, Manhattan, Minkowski etc.

\citet{davis1991nonparametric} were one of the first to show the application of a k-NN method in short
term traffic flow prediction. The authors used a minute aggregated traffic flow and occupancy data
collected at an intersection in an interstate highway. However a detail account of the results was
missing in the work, this could be because of the lack of data, as the authors used only about one and
half hour of data for this experiment.

The performance of a k-NN algorithm in short term traffic prediction was further demonstrated by
\citet{smith1994comparison}. They used k-nearest neighbour with k value of 10. For comparison purpose
they used a back propagation neural network model with one hidden layer. From their results, they
showed that nearest neighbour was more effective than the neural network model.
They also argued in favour of the usage of the nearest neighbour methods because nearest
neighbour methods are simple to understand by practitioners and easy to implement.
Another application of k-nearest neighbour
was by \citet{lv2009real} to predict highway traffic accidents. They used data collected from
inductive loop detectors along with historical traffic accident data. As per the authors knowledge
this was the first time this approach was used to identify traffic accidents. The changes between
normal traffic conditions and hazardous conditions were represented as traffic accident precursors.
Using these precursors, a 5-nearest neighbour method was proposed to identify hazardous conditions.

The advantages of using a non-parametric regression such as K-NN in short term traffic prediction
are their simplicity in modelling multivariate data, independence of the assumption on the state
transitions of the traffic conditions and intuitive model formulation (\citet{vlahogianni2004short}).

\subsection{Neural networks}
\label{subsec:neuralNetworksTrafficPred}
Artificial Neural Networks (ANN) were mathematical models (\citet{mcculloch1943logical},
\citet{rosenblatt1958perceptron}) designed to  provide a representation of how the human brain
works. It is now obvious that these mathematical models bear little resemblance to the structure
of brain, yet they have been hugely successful, especially recently. Because they were initially inspired by the
biological brain, the term neural is associated with such kind of mathematical models. A basic
artificial neural network consists of a set of nodes connected by edges with weights. We can say
that the nodes represent the biological neurons and the edges represent the synapses. The
connections among the nodes can be cyclic or acyclic. The former is known as a feedforward neural
network and the later as a recurrent network. We describe about these neural networks in more
details in chapter \ref{Chapter4}. Several variations of artificial neural networks have been
used in short term traffic prediction. Some well known examples include - \textit{Multilayer
perceptrons, Radial basis function networks, Kohnen maps} and \textit{Hopfield networks}.

\citet{clark1993use} made a comparison of neural networks and ARIMA models in an urban setting
and found only a slight difference between their performances. \citet{dougherty1997short} applied a
back propagation feedforward neural network to predict flow, occupancy and speed traffic parameters.
They found the prediction of speed to be disappointing. The results for the predictions of flow and occupancy,
although were not outstanding, showed some promise for further work in this area.
\citet{kirby1997should} extended the work of \citet{clark1993use} and compared a neural network model
with the ATHENA and ARIMA models. They concluded that the neural networks performed worse than the
ARIMA model for 30 and 60 minutes prediction horizons. However they argued that the neural networks
are by nature the most suited models to fit the traffic characteristics than the statistical time
series methods. \citet{yasdi1999prediction} used a Jordan neural network for traffic volume predictions.
The authors made forecasts for weekly, daily and hourly traffic volumes. For their work they used
data collected from traffic loop inductors and aggregated at fifteen minutes interval. The data was
then further classified based on events and stored in a knowledge base for reference. The results were
exceptional with an mean squared error (MSE) of less than 0.003.

\citet{dia2001object} used a time-lag recurrent network (TLRN) to predict traffic speed for fifteen
minutes horizon. They performed their experiment using data collected from a section of the Pacific Highway between
Brisbane and Gold Coast in Queensland, Australia. Unlike previous mentioned studies the authors used
an object-oriented dynamic neural network model. The dataset they used consisted of 5000
observations at 20 seconds of interval collected over five hour periods on two days. Their results
show that the model had an accuracy of 90-94\% for 5 minutes predictions. The accuracies dropped
to 84\% and 80\% for 10 and 15 minutes prediction horizons respectively. \citet{chen2001use} applied
a dynamic neural network model in this context, which was based on a resource allocating network (RAN).
The RAN is a single hidden layer neural network with no initial hidden units. The hidden units were added
dynamically and the number of hidden units corresponded to the complexity of the mapped function.
A maximum number of hidden units were set to 30 in this study. They used thier model on motorway
data collected on normal and incident related conditions. Their results showed that the performance of
 the dynamic model was better than the static model. Using five hidden units the model was able to
 achive a MAPE of approximately 9.5\% compared to the 11\% MAPE of the static model.

\citet{innamaa2005short} applied a feedforward MLP to predict travel time in an interurban highway.
They used data collected over a period of four months in a highway in southern Finland. The neural
network implemented for the experiment was very simple with one hidden layer and at most 20 units in
the hidden layer. Also they used separate neural networks for each sub-link to predict the average
travel time, thus in practice these are unrealistic to be implemented due to increased complexity.
On an average they achieved an accuracy of 90\%. They suggested inclusion of flow information could
have been beneficial. \citet{jiang2005dynamic} used a nonparametric dynamic time-delay recurrent
wavelet neural network model for forecasting traffic flow. They suggested that this model can be
used for both the short term and long term (from a day to a month) traffic flow forecasting. They
used a limited dataset and showed the results to be within 10\% error rate.

\citet{van2005accurate} studied the robustness of a state-space neural network (SSNN) to predict
travel time under missing data. The hidden layer had 12 units. The data used for experiment was
corrupted to contain both incidental and structural input failures. It was observed that the
SSNN model was insensitive to these corruptions. The model was compared with the
instantaneous predictor. The model outperformed the instantaneous predictor by a large margin. The authors
concluded that, in order to be practically applicable, a prediction model should be robust by not
being affected by missing or corrupt data. They also suggested simple imputation schemes such as spatial
interpolation or exponential forecsting to be used to handle missing data.


Neural networks are very powerful not only beacause of their good predictive ability but also due to their
robustness to missing and corrupt data and better modelling capability of the traffic conditions
with good overall performance. They are also capable of making better multi-step ahead predictions
than other mentioned methods.

\subsection{Support vector machine}
Since its inception, Support Vector Machines (SVM) have been very popular and widely used in a range of
classification and regression applications. This is due to their greater generalisation ability.
The basic idea of SVM is to map the data into a higher dimensional feature space and use a separating
hyperplane to classify the data. For regression problems, a version of SVM was proposed by
\citet{smola1997support} and is known as support vector regression. Similar to SVM, the SVR uses
a small subset of training data, because the cost function for the model ignores any data that is
close to the model prediction. Another version of SVM to solve regression problem is Least
Square Support Vector Machine (LS-SVM) proposed by \citet{suykens2002least}


In time series domain the use of SVR has been shown some promise, hence it was inevitable that its
application to traffic forecasting problem would remain untested. \citet{wu2004travel} used an SVR
model to predict travel time in a highway. They compared their model to a historical averages algorithm
and found better accuracies. However the authors did not present any reason of not comparing the model
with a stronger model such as neural networks.
\citet{zeng2008svr} proposed an online accurate support vector regressor (AOSVR) to increase the time
efficiency of traffic flow predictions. They first created an SVR model with Gaussian kernel and trained using an
LS-SVM algorithm. With the availability of new data the model parameters were updated online. A
comparison of this model with a simple neural network, with one hidden layer with 8 units, and
a historical averages method was done. Their results showed that the AOSVR model performed better
than the other methods.

\subsection{Bayesian networks}
A Bayesian network is a probabilistic graphical model, that uses a directed acyclic graph (DAG) to
represent a set of random variables and their conditional probabilities. In such a DAG the nodes
correspond to random variables and the edges correspond to the conditional probabilities. We can see
that the edges in such a DAG represent a direct causal influence and the belief in such a causal
structured network changes with new evidence. Formally we can define a Bayesian network as a
pair $(G,P)$, where $G$ is a DAG with a set of nodes $X$ and $P = \{p(x_{1}|\pi_{1}),..., p(x_{n}|\pi_{n})\}$
is a set of conditional probabilities with $\pi_{i}$ is the set of parent nodes of node $x_{i}$.
The joint probability of all nodes is defined as

     \begin{equation} p(X) =  \prod_{i = 1}^n p(x_{i}|\pi_{i}) \end{equation}

The joint probability distribution for a Gaussian Bayesian network is a multivariate
normal distribution $N(\mu, \Sigma)$, which is defined as

     \begin{equation}
      f(x) =  (2\pi)^{-n/2} \abs{\Sigma}^{-1/2} exp\{-1/2(x-\mu)^T \Sigma^{-1}(x-\mu)\}
     \end{equation}

One of the advantage of using a Bayesian network for traffic flow prediction is that they can
very easily model the multivariate traffic flow data to capture the tempo-spatial relations.

\citet{castillo2008predicting} proposed a Gaussian Bayesian network for traffic prediction. The idea
was to use the origin-destination (OD) and link flows as a multivariate random variable in this network.
The OD flows were used as parent nodes and the link flows as the child nodes. The conditional
probability of each link flow given the OD flows was defined as a normal distribution. Once the model
was built the joint probability distribution was used to predict the traffic flow for the links, when
new data were available. The authors argued that the Bayesian networks are natural tools for representing
the random dependence structures of traffic flows in OD pairs and link traffic flows. However, the authors did not
present any empirical comparison with other models that have been used in this field.


\section{Hybrid Methods}
In recent years many hybrid methods have been tried in short term traffic prediction with mixed
results. Many of these methods take a combined approach, where a forecasts of more than one methods
are combined to enhance the prediction accuracy.

One of the first hybrid approach used in short term traffic flow prediction was the ATHENA model.
The ATHENA model (\citet{danech1991athena}) employed a layered statistical approach. It
used a clustering method to group the data and then a linear regression model was applied
to each cluster. A hybrid method by combining Kohonen maps with ARIMA model was proposed by
\citet{van1996combining}. The model known as KARIMA, used the same data (collected near Beaune,
France) that was used in the ATHENA model for an accurate comparison with the later. The authors
used rectangular and hexagonal Kohonen maps to cluster the traffic volume data. Then each of the
new data cluster was fitted using an ARIMA model. This layered approach was similar to the ATHENA
model. The authors observed the superiority of the hexagonal Kohonen maps over the rectangular one,
but unable to determine the reason of that. Overall the model showed improved performance than the
ATHENA and a simple ARIMA model. \citet{chen2001study} analysed the use of hybrid neural
networks in the context of traffic prediction and the effect of missing data on those.
The authors used two hybrid methods using the self-organising maps (SOM). In the first method they
used four ARIMA models while in the second method two multi-layer perceptrons (MLP) were used.
The SOM was used to classify the traffic data into different cluster that can then be used by a
suitable ARIMA or MLP model. The SOM/ARIMA performed better than individual ARIMA models while the
SOM/MLP method outperformed all other methods used in the study. They also observed that the ARIMA
models were also the most sensitive to missing data, while neural networks were mostly unaffected.
\citet{szeto2009multivariate} used a hybrid SARIMA model with cell transmission
model for multivariate traffic prediction. The authors reasoned the use of multivariate models
captured the spatial characteristics of the transportation network and hence are the natural
and better choice over an univariate model. The model was validated against data collected form
the city centre in Dublin, Ireland. The results at two junctions were compared against real
observations and had MAPE of 4.45 and 10.6. The authors however did not provide comparison
against other univariate models or multivariate models which could present the model's relative
performance.

Both ARIMA and GARCH (Generalised Autoregressive Conditional Heteroscedasticity) models have received
a lot of popularity in time series modelling, especially in the financial analysis. The ARIMA-GARCH
model is a new hybrid method that has received some attention. \citet{chen2011short} proposed an
ARIMA-GARCH model for short term traffic prediction. The authors combines a linear ARIMA and a GARCH
model to create a hybrid non-linear model. The authors argued that, for traffic flow prediction, in
practice the assumption of ARIMA model for a constant variance is not met. Hence the combination with
the GARCH model which has time-dependent variance can improve the prediction accuracy. The ARIMA model
was fitted with preprocessed data. The prediction error series was then fitted with the GARCH model.
The process is repeated until the model is accurate enough. They evaluated the hybrid model's
performance by using traffic flow data collected from a freeway. The performance of the hybrid model
did not show any improvements over the standard ARIMA model and reached similar accuracies. The author
concluded that even though the model did not show improved performance, they are better choice over
a simple ARIMA model as they capture the traffic characteristics more comprehensively.

\citet{yin2002urban} used a hybrid fuzzy-neural model (FNM) for this task. The FNM model consisted of
two modules - a gate network (GN) and an expert network (EN). The role of the GN is to classify the
input traffic data into a group of clusters using a fuzzy method. On the other hand the EN was a
neural network that models the the clustered data for predictions. An online rolling training scheme
was proposed to train the FNM model. The performance of this model was done with a very simple neural
network model. It was observed clustering the input data beforehand helped improving the overall
performance. It would have been worth comparing the model performance with other hybrid models such
as the KARIMA model that takes a similar approach.\citet{stathopoulos2008fuzzy} proposed a fuzzy
rule-based system (FRBS) to combine traffic flow forecasts resulting from an online adaptive Kalman
filter and an artificial neural network. The FRBS is used to represent different forms of knowledge
at hand and model the relationships among the variables. The authors used a hybrid FRBS with a
meta-heuristic optimisation technique, to automate the tuning of its parameters. The combining of
forecasts from the ANN and KF models were done using IF-THEN rules in the rule base. They evaluated
this model using real traffic flow data from a urban signalised arterial aggregated at 3-minutes
interval. The combines forecasts were better than both individual forecasts. Moreover, the accuracy
of the combined model is directly related to the individual accuracies.

\citet{abdulhai2002short} validated the used of neuro-genetic algorithms in short term traffic flow and
occupancy predictions on a freeway. They used a time delayed neural network (TDNN) model, whose
structure was synthesised by using a genetic algorithm. The model used tried to capture the
tempo-spatial relationships in the traffic conditions by using the traffic data from upstream and
downstream sections. A genetic algorithm was used to chose the neural network from a population. The
model performance was validated using both simulated and real traffic data. The comparisons were made
against a back propagation feedforward MLP. The model performed acceptably with an accuracy of 86\% for
15 minutes predictions. The model performance was significantly affected for less spatial effects.
\citet{vlahogianni2005optimized} took a similar approach where the neural network structure was optimised
using a genetic algorithm. The use of GA was to optimise the number of processing units in the hidden
layer. When compared with a non-optimised MLP they found that the optimised version reached similar
performance with less number of hidden units. They evaluated the model in first using univariate traffic
flow data and compared the results with an ARIMA and a state space model. The results were better than
the compared models, but on the other hand it was found that ARIMA models do not perform well for urban
traffic flow as they concentrate on the means and miss the extreme; Thus this comparison seemed unfair.
They also evaluated the model performance in a multivariate traffic flow data to capture the spatial
relationships. The results show that using this multivariate approach, the model exhibited a better
performance for longer predictive horizons.

\section{Comparisons}
A vast majority of the previous work present some form of comparison between different methods based
on the empirical results. But as the results apply only to a specific area, we can not make these
as the basis for a general comparison between these methods. Also in most cases the comparison is
subjective to the proposed model by the author. \citet{smith2002comparison} performed
a comparison between non-parametric and parametric regression models for single point traffic flow
forecasting based on their theoretical foundations. They found the parameter estimation and outlier
detection using a seasonal ARIMA model is time consuming, hence in practical situations they may not be the
best suited. While ARIMA models have their foundations in stochastic system theory, the non-parametric
regression is founded on chaotic system theory. The argument that is in favour of using ARIMA models
is that traffic conditions data are stochastic in nature. Although this is a valid assumption, the
presence of chaotic nature in traffic data can not be dismissed, especially in a congested traffic
environment. \citet{hu2003applicable} explored this and applied phase space reconstruction theory to
forecast traffic flow and found some positive results. In a similar context \citet{karlaftis2011statistical}
performed a comparison between statistical methods and neural networks. In this work they outlines some
similarities and fundamental differences between these methods. They suggested three areas where these
two methods can act in synergy and compliment each other, these are - core model development, analysis
of large data sets and causality investigation. They also argued that the comparison of these methods in
several work as unfair, as they are solely based on model accuracies.

It is also worth mentioning here that the majority of earlier work focus on prediction of a traffic
parameter such as flow at a single location. A very few attempts have been made to predict traffic flow
at a network level. Because in practice this is more valuable in both urban and freeway environments.
\citet{van2007short} summarised a list of existing methods used in traffic predictions and mentioned
the importance of a model that predicts at a larger network-wide scale.

We present a summary of the comparisons among the above mentioned methods in the table
\ref{table:comparisonExistingMethods}. The comparisons show the basic characteristics of the methods,
the requirements on the input data and overall advantages and disadvantages of the methods. In
chapter \ref{Chapter5}, we present an empirical comparison of these methods.

\begin{table}
    \begin{tabular}{c}
        \includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{Figures/method-comparisons.pdf}
    \end{tabular}
    \caption[Comparison of existing methods]{Comparison of existing methods applied in short term
     traffic predictions.}
    \label{table:comparisonExistingMethods}
\end{table}