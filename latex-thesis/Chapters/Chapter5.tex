% Chapter 5

\chapter{Evaluation of the Model} % Main chapter title

\label{Chapter5} % For referencing the chapter elsewhere, use \ref{Chapter5}

% This is for the header on each page - perhaps a shortened title
\lhead{Chapter 5. \emph{Evaluation of the Model}}

% Quotation
``Science, my boy, is made up of mistakes, but they are mistakes which it is useful to make,because
they lead little by little to the truth"

\begin{flushright}
Jules Verne, \textit{Journey to the Centre of the Earth} (1864)
\end{flushright}

%---------------------------------------------------------------------------------------------------
%	CONTENT
%---------------------------------------------------------------------------------------------------

\section{Experimental setup}
% Brunswick Road - 6336, 6338; 16572
% Flemington Road - 3393, 3394, 3396, 3398; 13632, 13634, 13635, 13637
% Elizabeth Street -
% Victorial Parade - 3592, 3593, 3594, 3595, 3596; 13829, 13831, 13832, 13835
% Hoddle Street - 268, 272, 273, 274, 275, 277, 278; 6278, 10522, 10523, 10525, 10526, 10527, 10528, 16515, 16517
% Nicholson Street - 5539, 5540, 5541, 5543, 5544, 5545, 9615; 15773, 15774, 15775, 15777, 15778, 19854, 19855
% Royal Parade - 6782, 6783, 6784, 6786; 17022, 17023, 17025
% Lygon Street - 9424, 9425, 9426, 9427, 9429; 19659, 19660, 19661, 19662, 19663
We chose a subset of the obtained traffic data for experimentation as shown in the figure
\ref{fig:ExperimentRegion}. The region boundary of the subnetwork is denoted by the red line.

\begin{figure}[htbp]
  \centering
    \includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{Figures/experiment-region.pdf}
    \rule{35em}{0.5pt}
  \caption[Experiment traffic region]{The traffic region used in this experiment. The boundary is
   dentoed by the red line.}
  \label{fig:ExperimentRegion}
\end{figure}

\subsection{Training details}
We trained our stacked LSTM network(\ref{sec:stackedLSTMTrafficPred})

\section{Results}

For comparison purose we used the following methods that have been in used predominantly in short
term traffic prediction - Na誰ve, Linear regression, ARIMA, Exponential smoothing and Feedforward
neural network. In figure \ref{fig:benchmarkModels}, we present the predictions of these models
on test data. The input sequence was set to 96 observations(1 day) and the prediction was done for
next 15 minutes(1 step ahead).


\begin{figure}[h]
    \centering

    \subfloat[Na誰ve][Na誰ve]{
    \includegraphics[width=0.4\textwidth]{Figures/naive.pdf}
    \label{fig:naiveActualPredicted}}
    \qquad
    \subfloat[Mean Forecast][Mean Forecast]{
    \includegraphics[width=0.4\textwidth]{Figures/meanf.pdf}
    \label{fig:meanfActualPredicted}}

    \subfloat[Linear Regression][Linear Regression]{
    \includegraphics[width=0.4\textwidth]{Figures/linear-regression.pdf}
    \label{fig:LmActualPredicted}}
    \qquad
    \subfloat[ARIMA][ARIMA]{
    \includegraphics[width=0.4\textwidth]{Figures/arima.pdf}
    \label{fig:ArimaActualPredicted}}

    \subfloat[Exponential smoothing state space model][Exponential smoothing state space model]{
    \includegraphics[width=0.4\textwidth]{Figures/exp-smoothing.pdf}
    \label{fig:etsActualPredicted}}
    \qquad
    \subfloat[Neural Network AutoRegression][Neural Network AutoRegression]{
    \includegraphics[width=0.4\textwidth]{Figures/nnetar.pdf}
    \label{fig:NnetarActualPredicted}}

    \caption[Acutual vs Predictions, using currently popular methods]{Acutual vs Predictions -
    linear regression, ARIMA, feed forward neural network one hidden layer and exponential
    smoothing using state space model. The models were trained on trafiic data from one homogeneous
    road segment. The plots show the actual vs predictions(15 mins) on 400 test examples, for one
    of those road segment (Nicholson street between Gertrude street and Victoria Parade).}
    \label{fig:benchmarkModels}
\end{figure}

The results of the LSTM network are shown in the figure \ref{fig:LSTMActualPredicted}

\begin{figure}[h]
    \centering

    \subfloat[Stacked LSTM - single location][Single location]{
    \includegraphics[width=0.4\textwidth]{Figures/lstm.pdf}
    \label{fig:LSTMActualPredicted1}}
    \qquad
    \subfloat[Stacked LSTM - multiple locations][Multiple locations]{
    \includegraphics[width=0.4\textwidth]{Figures/lstm.pdf}
    \label{fig:LSTMActualPredicted2}}

    \caption[Acutual vs Predictions, using deep LSTM networks]{Acutual vs Predictions - The left
    figure is from the model trained using data from a single homogeneous road segment only. The
    figure in right is from the model trained on 67 homogeneous road segements in the chosen
    subnetwork(\ref{fig:ExperimentRegion}). Both the plots show the actual vs predictions(15
    mins) on 400 test examples, for one of those road segment(Nicholson street between Gertrude
    street and Victoria Parade).}
    \label{fig:LSTMActualPredicted}
\end{figure}

In table \ref{table:accuracyScores}, the performance of the LSTM network along with the compared
models are given.

Several accuracy measures exist to evaluate a model. In below secions we describe
the accuracy mesures and use those to evalute our proposed model against the benchmark models.
For defining the accuracy measures let us denote $x_{i}$ be the $i^{th}$ observation and
$\hat{x}_{i}$ be the prediction of $x_{i}$.

\textbf{Scale-dependent errors}
The prediction error is simply given by $e_{i} = x_{i} - \hat{x}_{i}$, which is in the same scale
as of the original data. So accuracy measures that depend on $e_{i}$ are scale dependent and can
not be used across multiple series on different scales. The two most used scale-dependent
accuracy measures are mean absolute error and root mean squared error defined as below

    \begin{equation}
        MAE = mean(\abs{e_{i}})
    \end{equation}
    \begin{equation}
        RMSE = \sqrt{mean(e^{2}_{i})}
    \end{equation}

MAE is easy to understand and popular in usage when using a single dataset.

\textbf{Percentage errors}
Percentage errors are scale-independent and thus used across multiple datasets on different
scales. The percentage error is given by $p_{i} = 100*e_{i}/x_{i}$. The most commonly used
percentage measure is Mean Absolute Percentage Error(MAPE) which is given by the below formula
    \begin{equation}
        MAPE = mean(\abs{p_{i}})
    \end{equation}

There are however few shortccomings of the MAPE, for instance when $x_{i}$ is 0 or very large.
Another shortcoming is that they put heavier penalty on negative error values than positve error
values.

\textbf{Scaled errors}
\citet{hyndman2006another} proposed scaled errors to be used as an alternative in place of
percentage errors. The proposed Mean Absolute Scaled Error(MASE) is defined as

    \begin{equation}
        MASE = mean(\abs{q_{i}})
    \end{equation}

where
    \begin{equation}
        q_{i} = \frac{e_{i}}{\frac{1}{T-1} \displaystyle\sum_{t=2}^{T}\abs{x_{t} - x_{t-1}}}
    \end{equation}

A scaled error is less than one if it is better than the average na誰ve forecast computed on the
training data and vice versa.


\begin{table}
\centering
    \begin{tabular}{| l | l | l| l | l | l | l|} \hline
        \textbf{Model}  & \textbf{ME} & \textbf{MAE} & \textbf{RMSE} & \textbf{MPE(\%)} & \textbf{MAPE(\%)} & \textbf{MASE} \\ \hline
        \multicolumn{7}{|c|}{15 minutes} \\ \hline
        Mean Forecast                    & 10.73 & 48.13 & 48.13 & -63.61 & 98.34 & 1.57 \\ \hline
        Naive                            & -0.18 & 15.25 & 15.25 & -5.65 & 21.24 & 0.49 \\ \hline
        Linear Regression                & 9.75 & 50.30 & 50.30 & -62.20 & 97.84 & 1.65 \\ \hline
        ARIMA                            & 1.87 & 15.10 & 15.10 & -6.05 & 21.30 & 1.02 \\ \hline
        Eponential Smoothing             & 0.04 & 15.33 & 15.33 & -5.48 & 20.68 & 1.04 \\ \hline
        Neural Network AutoRegression    & 5.61 & 19.40 & 19.40 & -5.51 & 24.29 & 1.30 \\ \hline
        Deep LSTM(single location)       &  &  &  &  &  &  \\ \hline
        Deep LSTM(multiple locations)    &  &  &  &  &  &  \\ \hline
        \multicolumn{7}{|c|}{30 minutes} \\ \hline
        Mean Forecast                    & 10.29 & 47.13 & 48.31 & -63.63 & 98.27 & 1.54 \\ \hline
        Naive                            & -0.62 & 16.65 & 18.16 & -6.35 & 23.02 & 0.54 \\ \hline
        Linear Regression                & 9.30 & 49.30 & 50.38 & -62.67 & 98.30 & 1.62 \\ \hline
        ARIMA                            & 2.42 & 16.56 & 18.02 & -7.18 & 23.67 & 1.12 \\ \hline
        Eponential Smoothing             & -0.61 & 16.66 & 18.08 & -5.74 & 22.20 & 1.13 \\ \hline
        Neural Network AutoRegression    & 6.61 & 19.54 & 20.98 & -4.51 & 25.06 & 1.33 \\ \hline
        Deep LSTM(single location)       &  &  &  &  &  &  \\ \hline
        Deep LSTM(multiple locations)    &  &  &  &  &  &  \\ \hline
    \end{tabular}
    \caption[Model comparisons]{Accuracy measures for the evaluted models. The scores are
    calculated for prediction horizon of 15-minutes(top half) and 30-minutes(bottom half). Mean
    15-minutes traffic volume is 104.4}
    \label{table:accuracyScores}
\end{table}
